<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="workloopR">
<title>Working with isometric experiments in workloopR • workloopR</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with isometric experiments in workloopR">
<meta property="og:description" content="workloopR">
<meta property="og:image" content="https://docs.ropensci.org/workloopR/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">workloopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/Introduction-to-workloopR.html">Introduction to workloopR</a>
    <a class="dropdown-item" href="../articles/non-ddf-sources.html">Importing data from non .ddf sources</a>
    <a class="dropdown-item" href="../articles/Calculating-twitch-kinetics.html">Working with isometric experiments</a>
    <a class="dropdown-item" href="../articles/Analyzing-workloops.html">Analyzing work loop experiments</a>
    <a class="dropdown-item" href="../articles/batch-processing.html">Batch processing</a>
    <a class="dropdown-item" href="../articles/Plotting-workloopR.html">Plotting data in workloopR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/workloopR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Working with isometric experiments in workloopR</h1>
                        <h4 data-toc-skip class="author">Vikram B. Baliga</h4>
            
            <h4 data-toc-skip class="date">2024-02-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/workloopR/blob/HEAD/vignettes/Calculating-twitch-kinetics.Rmd" class="external-link"><code>vignettes/Calculating-twitch-kinetics.Rmd</code></a></small>
      <div class="d-none name"><code>Calculating-twitch-kinetics.Rmd</code></div>
    </div>

    
    
<p>The <code>workloopR</code> package also provides a function that can calculate the timing and magnitude of force during isometric experiments (twitch, tetanus) via the <code><a href="../reference/isometric_timing.html">isometric_timing()</a></code> function.</p>
<p>To demonstrate, we will first load <code>workloopR</code> and use example data provided with the package. We’ll also load a couple packages within the <code>tidyverse</code> as well as <code>viridis</code> to help with data wrangling and plotting.</p>
<div class="section level2">
<h2 id="load-packages-and-data">Load packages and data<a class="anchor" aria-label="anchor" href="#load-packages-and-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/workloopR/">workloopR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize">Visualize<a class="anchor" aria-label="anchor" href="#visualize"></a>
</h2>
<p>We’ll now import the <code>twitch.ddf</code> file included with <code>workloopR</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## The file twitch.ddf is included and therefore can be accessed via</span></span>
<span><span class="co">## system.file("subdirectory","file_name","package") . We'll then use</span></span>
<span><span class="co">## read_ddf() to import it, creating an object of class "muscle_stim".</span></span>
<span><span class="va">twitch_dat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"twitch.ddf"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">'workloopR'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/read_ddf.html">read_ddf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Let’s plot Force vs. Time to visualize the time course of force development and relaxation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twitch_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Force</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Force (mN)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (sec)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Calculating-twitch-kinetics_files/figure-html/intial_plot-1.png" width="700"></p>
<p>This plot reveals that the final row of the data has Force = 0 and is likely an artifact. We can also see that the most salient parts of the twitch occur between ~ 0.075 and ~ 0.2 seconds.</p>
<p>We’ll just re-plot the salient parts of the twitch by setting new limits on the axes via <code><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ggplot2::xlim()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ggplot2::ylim()</a></code>. Please note that this will not change any analyses - we are simply doing it for ease of visualizing patterns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Re-plot</span></span>
<span><span class="va">twitch_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Force</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.075</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">450</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (sec)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Force (mN)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2750 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="Calculating-twitch-kinetics_files/figure-html/data_cleaning-1.png" width="700"></p>
<p>Looks better!</p>
</div>
<div class="section level2">
<h2 id="basics-of-isometric_timing">Basics of <code>isometric_timing()</code><a class="anchor" aria-label="anchor" href="#basics-of-isometric_timing"></a>
</h2>
<p>Now we’re ready to use <code><a href="../reference/isometric_timing.html">isometric_timing()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Run the isometric_timing() function</span></span>
<span><span class="va">twitch_analyzed</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">twitch_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/isometric_timing.html">isometric_timing</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">twitch_analyzed</span></span>
<span><span class="co">#&gt;      file_id time_stim force_stim time_peak force_peak time_rising_10</span></span>
<span><span class="co">#&gt; 1 twitch.ddf    0.1002    224.067    0.1141   412.4495         0.1048</span></span>
<span><span class="co">#&gt;   force_rising_10 time_rising_90 force_rising_90 time_relaxing_90</span></span>
<span><span class="co">#&gt; 1         244.389         0.1107        393.9015           0.1198</span></span>
<span><span class="co">#&gt;   force_relaxing_90 time_relaxing_50 force_relaxing_50</span></span>
<span><span class="co">#&gt; 1           394.063           0.1311          318.2585</span></span></code></pre></div>
<p>The function returns a new <code>data.frame</code> that provides information about the timing and magnitude of force at various intervals within the twitch. All returned values are absolute; in other words, time is measured from the beginning of the file and forces are returned in their actual magnitudes.</p>
<p>The first five columns of this <code>data.frame</code> are fixed. They will return (in this order): 1) the ID of the file, 2) the time at which stimulation occurs, 3) magnitude of force when stimulation occurs, 4) time at which peak force occurs, and 5) magnitude of peak force.</p>
<p>The function also provides data that help describe the rising and the relaxation phases of the twitch at certain “set points”. By default, in the rising phase the set points are at 10% and at 90% of peak force development. Timing and force magnitudes at these points are returned as columns in the <code>data.frame</code>. And for the relaxation phase, the time and magnitude of force when force has relaxed to 90% and 50% of peak force are given.</p>
<p>The user has some flexibility in specifying how data are grabbed from the rising and falling phases. There are two arguments: <code>rising = c()</code> and <code>falling = c()</code>. Each of these arguments can be filled with a vector of any length. Within the vector, each of these “set points” must be a vector between 0 and 100, signifying the % of peak force development that is to be described.</p>
<p>For example, if we’d like to describe the rising phase at six points (e.g. 5%, 10%, 25%, 50%, 75%, and 95% of peak force development):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Change rising supply a custom set of force development set points</span></span>
<span><span class="va">twitch_rising_custom</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">twitch_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/isometric_timing.html">isometric_timing</a></span><span class="op">(</span>rising <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The returned `data.frame` contains the timing and force magnitudes</span></span>
<span><span class="co">## of these set points in the "..._rising_..." columns</span></span>
<span><span class="va">twitch_rising_custom</span></span>
<span><span class="co">#&gt;      file_id time_stim force_stim time_peak force_peak time_rising_5</span></span>
<span><span class="co">#&gt; 1 twitch.ddf    0.1002    224.067    0.1141   412.4495        0.1044</span></span>
<span><span class="co">#&gt;   force_rising_5 time_rising_10 force_rising_10 time_rising_25 force_rising_25</span></span>
<span><span class="co">#&gt; 1        234.712         0.1048         244.389         0.1057         273.743</span></span>
<span><span class="co">#&gt;   time_rising_50 force_rising_50 time_rising_75 force_rising_75 time_rising_95</span></span>
<span><span class="co">#&gt; 1          0.107             321         0.1087        366.1605         0.1118</span></span>
<span><span class="co">#&gt;   force_rising_95 time_relaxing_90 force_relaxing_90 time_relaxing_50</span></span>
<span><span class="co">#&gt; 1         403.579           0.1198           394.063           0.1311</span></span>
<span><span class="co">#&gt;   force_relaxing_50</span></span>
<span><span class="co">#&gt; 1          318.2585</span></span></code></pre></div>
<div class="section level3">
<h3 id="tetanus-trials">Tetanus trials<a class="anchor" aria-label="anchor" href="#tetanus-trials"></a>
</h3>
<p>The <code><a href="../reference/isometric_timing.html">isometric_timing()</a></code> function can also work on <code>tetanus</code> objects that have been imported via <code><a href="../reference/read_ddf.html">read_ddf()</a></code>. Should a <code>tetanus</code> object be used, the set points for relaxing are automatically set to <code>relaxing = c()</code>, which excludes this argument from producing anything. Instead, the timing &amp; magnitude of force at stimulation, peak force, and specified points of the rising phase are returned. The idea of ‘relaxation’ is simply ignored.</p>
<p>To demonstrate, we’ll use an example tetanus trial included in <code>workloopR</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tetanus_analyzed</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"tetanus.ddf"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">'workloopR'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/read_ddf.html">read_ddf</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/isometric_timing.html">isometric_timing</a></span><span class="op">(</span>rising <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tetanus_analyzed</span></span>
<span><span class="co">#&gt;       file_id time_stim force_stim time_peak force_peak time_rising_25</span></span>
<span><span class="co">#&gt; 1 tetanus.ddf    0.1002   141.0045    0.1364   2626.289         0.1135</span></span>
<span><span class="co">#&gt;   force_rising_25 time_rising_50 force_rising_50 time_rising_75 force_rising_75</span></span>
<span><span class="co">#&gt; 1        763.4095         0.1184        1391.462         0.1236        2013.873</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="computing-intervals">Computing intervals<a class="anchor" aria-label="anchor" href="#computing-intervals"></a>
</h2>
<p>The returned <code>data.frame</code> provides all timing and force magnitudes in absolute terms, i.e. time since the start of the file and actual force magnitudes. Often, we’d like to report characteristics of the twitch as intervals.</p>
<p>To calculate, e.g. the interval between stimulation and peak force (often reported as “time to peak force”):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Time to peak force from stimulation</span></span>
<span><span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_peak</span> <span class="op">-</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_stim</span></span>
<span><span class="co">#&gt; [1] 0.0139</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="annotate-the-twitch-plot">Annotate the twitch plot<a class="anchor" aria-label="anchor" href="#annotate-the-twitch-plot"></a>
</h2>
<p>It is also good to plot some of these metrics and see if they pass the eye-test.</p>
<p>We’ll use our analyzed twitch and the <code>viridis</code> package to supply colors to dots at key points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create a color pallete</span></span>
<span><span class="co">## Generated using `viridis::viridis(6)`</span></span>
<span><span class="co">## We use hard-coded values here just to avoid extra dependencies </span></span>
<span><span class="va">colz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#440154FF"</span>,<span class="st">"#414487FF"</span>,<span class="st">"#2A788EFF"</span>,</span>
<span>          <span class="st">"#22A884FF"</span>,<span class="st">"#7AD151FF"</span>,<span class="st">"#FDE725FF"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">twitch_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Force</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.075</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">450</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time (sec)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Force (mN)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_stim</span>, </span>
<span>              y <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">force_stim</span>,</span>
<span>              color <span class="op">=</span> <span class="va">colz</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_peak</span>, </span>
<span>              y <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">force_peak</span>,</span>
<span>              color <span class="op">=</span> <span class="va">colz</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_rising_10</span>, </span>
<span>              y <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">force_rising_10</span>,</span>
<span>              color <span class="op">=</span> <span class="va">colz</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_rising_90</span>, </span>
<span>              y <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">force_rising_90</span>,</span>
<span>              color <span class="op">=</span> <span class="va">colz</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_relaxing_90</span>, </span>
<span>              y <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">force_relaxing_90</span>,</span>
<span>              color <span class="op">=</span> <span class="va">colz</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">time_relaxing_50</span>, </span>
<span>              y <span class="op">=</span> <span class="va">twitch_analyzed</span><span class="op">$</span><span class="va">force_relaxing_50</span>,</span>
<span>              color <span class="op">=</span> <span class="va">colz</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 2750 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="Calculating-twitch-kinetics_files/figure-html/annotated_plot-1.png" width="700"></p>
<p>The plot has dots added for each of the six time&amp;force points that the function returns by default.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
