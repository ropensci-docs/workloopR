<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="read_analyze_wl() is an all-in-one function to read in a work loop
file, select cycles, and compute work and power output."><title>All-in-one import function for work loop files — read_analyze_wl • workloopR</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="All-in-one import function for work loop files — read_analyze_wl"><meta property="og:description" content="read_analyze_wl() is an all-in-one function to read in a work loop
file, select cycles, and compute work and power output."><meta property="og:image" content="https://docs.ropensci.org/workloopR/logo.png"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">workloopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/Introduction-to-workloopR.html">Introduction to workloopR</a>
    <a class="dropdown-item" href="../articles/non-ddf-sources.html">Importing data from non .ddf sources</a>
    <a class="dropdown-item" href="../articles/Calculating-twitch-kinetics.html">Working with isometric experiments</a>
    <a class="dropdown-item" href="../articles/Analyzing-workloops.html">Analyzing work loop experiments</a>
    <a class="dropdown-item" href="../articles/batch-processing.html">Batch processing</a>
    <a class="dropdown-item" href="../articles/Plotting-workloopR.html">Plotting data in workloopR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/workloopR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>All-in-one import function for work loop files</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/workloopR/blob/HEAD/R/analysis_functions.R" class="external-link"><code>R/analysis_functions.R</code></a></small>
      <div class="d-none name"><code>read_analyze_wl.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>read_analyze_wl()</code> is an all-in-one function to read in a work loop
file, select cycles, and compute work and power output.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_analyze_wl</span><span class="op">(</span><span class="va">file_name</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>file_name</dt>
<dd><p>A .ddf file that contains data from a
single workloop experiment</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to <code><a href="read_ddf.html">read_ddf()</a></code>,
<code><a href="select_cycles.html">select_cycles()</a></code>,
or <code><a href="analyze_workloop.html">analyze_workloop()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function returns a <code>list</code> of class <code>analyzed_workloop</code></p>


<p>that provides instantaneous velocity, a smoothed velocity, and computes work,
 instantaneous power, and net power from a work loop experiment. All data are
 organized by the cycle number and important metadata are stored as
 Attributes.</p>


<p>Within the <code>list</code>, each entry is labeled by cycle and includes:</p>
<dl><dt>Time</dt>
<dd><p>Time, in sec</p></dd>

<dt>Position</dt>
<dd><p>Length change of the muscle, corrected for gear ratio, in mm</p></dd>

<dt>Force</dt>
<dd><p>Force, corrected for gear ratio, in mN</p></dd>

<dt>Stim</dt>
<dd><p>When stimulation occurs, on a binary scale</p></dd>

<dt>Cycle</dt>
<dd><p>Cycle ID, as a letter</p></dd>

<dt>Inst_velocity</dt>
<dd><p>Instantaneous velocity, computed from <code>Position</code>
change, reported in meters/sec</p></dd>

<dt>Filt_velocity</dt>
<dd><p>Instantaneous velocity, after low-pass filtering, again
 in meter/sec</p></dd>

<dt>Inst_Power</dt>
<dd><p>Instantaneous power, a product of <code>Force</code> and
<code>Filt_velocity</code>, reported in J</p></dd>

<dt>Percent_of_Cycle</dt>
<dd><p>The percent of that particular cycle which has
elapsed</p></dd>


</dl><p>In addition, the following information is stored in the
<code>analyzed_workloop</code> object's attributes:</p>
<dl><dt>stimulus_frequency</dt>
<dd><p>Frequency at which stimulus pulses occurred</p></dd>

<dt>cycle_frequency</dt>
<dd><p>Frequency of oscillations (assuming sine wave
trajectory)</p></dd>

<dt>total_cycles</dt>
<dd><p>Total number of oscillatory cycles (assuming sine wave
trajectory) that the muscle experienced.</p></dd>

<dt>cycle_def</dt>
<dd><p>Specifies what part of the cycle is understood as the
beginning and end. There are currently three options:
'lo' for L0-to-L0;
'p2p' for peak-to-peak; and
't2t' for trough-to-trough</p></dd>

<dt>amplitude</dt>
<dd><p>Amplitude of length change (assuming sine wave
trajectory)</p></dd>

<dt>phase</dt>
<dd><p>Phase of the oscillatory cycle (in percent) at which stimulation
occurred. Somewhat experimental, please use with caution</p></dd>

<dt>position_inverted</dt>
<dd><p>Logical; whether position inversion has been
applied)</p></dd>

<dt>units</dt>
<dd><p>The units of measurement for each column in the object after
running this function. See Warning</p></dd>

<dt>sample_frequency</dt>
<dd><p>Frequency at which samples were collected</p></dd>

<dt>header</dt>
<dd><p>Additional information from the header</p></dd>

<dt>units_table</dt>
<dd><p>Units from each Channel of the original ddf file</p></dd>

<dt>protocol_table</dt>
<dd><p>Protocol in tabular format; taken from the original
ddf file</p></dd>

<dt>stim_table</dt>
<dd><p>Specific info on stimulus protocol; taken from the original
ddf file</p></dd>

<dt>stimulus_pulses</dt>
<dd><p>Number of sequential pulses within a stimulation
train</p></dd>

<dt>stimulus_offset</dt>
<dd><p>Timing offset at which stimulus began</p></dd>

<dt>gear_ratio</dt>
<dd><p>Gear ratio applied by this function</p></dd>

<dt>file_id</dt>
<dd><p>File name</p></dd>

<dt>mtime</dt>
<dd><p>Time at which file was last modified</p></dd>

<dt>retained_cycles</dt>
<dd><p>Which cycles were retained, as numerics</p></dd>

<dt>summary</dt>
<dd><p>Simple table showing work (in J) and net power (in W) for each
 cycle</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Please be careful with units! See Warnings below. This function
combines <code><a href="read_ddf.html">read_ddf()</a></code> with <code><a href="select_cycles.html">select_cycles()</a></code> and then ultimately
<code><a href="analyze_workloop.html">analyze_workloop()</a></code> into one handy function.</p>
<p>As detailed in these three functions, possible arguments include: <br><code>cycle_def</code> - used to specify which part of the cycle is understood as
the beginning and end. There are currently three options: 'lo' for L0-to-L0;
'p2p' for peak-to-peak; and 't2t' for trough-to-trough <br><code>bworth_order</code> - Filter order for low-pass filtering of <code>Position</code>
 via <code><a href="https://rdrr.io/pkg/signal/man/butter.html" class="external-link">signal::butter</a></code> prior to finding peak lengths. Default: 2. <br><code>bworth_freq</code> - Critical frequency (scalar) for low-pass filtering of
<code>Position</code> via <code><a href="https://rdrr.io/pkg/signal/man/butter.html" class="external-link">signal::butter</a></code> prior to finding peak lengths.
Default: 0.05. <br><code>keep_cycles</code> - Which cycles should be retained. Default: 4:6. <br><code>GR</code> - Gear ratio. Default: 1. <br><code>M</code> - Velocity multiplier used to positivize velocity; should be either
-1 or 1. Default: -1. <br><code>vel_bf</code> - Critical frequency (scalar) for low-pass filtering of
velocity via <code><a href="https://rdrr.io/pkg/signal/man/butter.html" class="external-link">signal::butter</a></code>. Default: 0.05. <br></p>
<p>The gear ratio (GR) and velocity multiplier (M) parameters can help correct
for issues related to the magnitude and sign of data collection. By
default, they are set to apply no gear ratio adjustment and to positivize
velocity. Instantaneous velocity is often noisy and the <code>vel_bf</code>
parameter allows for low-pass filtering of velocity data. See
<code><a href="https://rdrr.io/pkg/signal/man/butter.html" class="external-link">signal::butter()</a></code> and <code><a href="https://rdrr.io/pkg/signal/man/filtfilt.html" class="external-link">signal::filtfilt()</a></code> for details of how
filtering is achieved.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    

<p>Most systems we have encountered record Position data in millimeters
and Force in millinewtons, and therefore this function assumes data are
recorded in those units. Through a series of internal conversions, this
function computes velocity in meters/sec, work in Joules, and power in
Watts. If your raw data do not originate in millimeters and millinewtons,
please transform your data accordingly and ignore what you see in the
attribute <code>units</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Josephson RK. 1985. Mechanical Power output from Striated Muscle
 during Cyclic Contraction. Journal of Experimental Biology 114: 493-512.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_ddf.html">read_ddf</a></code>,
<code><a href="select_cycles.html">select_cycles</a></code>
<code><a href="analyze_workloop.html">analyze_workloop</a></code></p>
<p>Other data analyses: 
<code><a href="analyze_workloop.html">analyze_workloop</a>()</code>,
<code><a href="isometric_timing.html">isometric_timing</a>()</code>,
<code><a href="read_analyze_wl_dir.html">read_analyze_wl_dir</a>()</code></p>
<p>Other data import functions: 
<code><a href="as_muscle_stim.html">as_muscle_stim</a>()</code>,
<code><a href="get_wl_metadata.html">get_wl_metadata</a>()</code>,
<code><a href="read_analyze_wl_dir.html">read_analyze_wl_dir</a>()</code>,
<code><a href="read_ddf_dir.html">read_ddf_dir</a>()</code>,
<code><a href="read_ddf.html">read_ddf</a>()</code></p>
<p>Other workloop functions: 
<code><a href="analyze_workloop.html">analyze_workloop</a>()</code>,
<code><a href="fix_GR.html">fix_GR</a>()</code>,
<code><a href="get_wl_metadata.html">get_wl_metadata</a>()</code>,
<code><a href="invert_position.html">invert_position</a>()</code>,
<code><a href="read_analyze_wl_dir.html">read_analyze_wl_dir</a>()</code>,
<code><a href="select_cycles.html">select_cycles</a>()</code>,
<code><a href="summarize_wl_trials.html">summarize_wl_trials</a>()</code>,
<code><a href="time_correct.html">time_correct</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Vikram B. Baliga</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/workloopR/">workloopR</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># import the workloop.ddf file included in workloopR and analyze with</span></span></span>
<span class="r-in"><span><span class="co"># a gear ratio correction of 2 and cycle definition of peak-to-peak</span></span></span>
<span class="r-in"><span><span class="va">wl_dat</span> <span class="op">&lt;-</span> <span class="fu">read_analyze_wl</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"workloop.ddf"</span>,</span></span>
<span class="r-in"><span>                                      package <span class="op">=</span> <span class="st">'workloopR'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          phase_from_peak <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                          GR <span class="op">=</span> <span class="fl">2</span>, cycle_def <span class="op">=</span> <span class="st">"p2p"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

